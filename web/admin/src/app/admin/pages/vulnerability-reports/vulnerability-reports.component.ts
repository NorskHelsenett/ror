import { Component, ViewChild } from '@angular/core';
import { TabView, TabViewModule } from 'primeng/tabview';
import { VulnerabilityReportsByClusterComponent } from '..';

@Component({
  selector: 'app-vulnerability-reports',
  templateUrl: './vulnerability-reports.component.html',
  styleUrls: ['./vulnerability-reports.component.scss'],
  providers: [TabViewModule],
})
export class VulnerabilityReportsComponent {
  @ViewChild(TabView) tabView: TabView;
  @ViewChild('clustertable') clustertable: VulnerabilityReportsByClusterComponent;
  @ViewChild('cvstable') cvetable: any;
  summaryPerCluster: any[] = [];
  summaryById: any[] = [];
  activeIndex: number = 0;

  updateSummaryPerCluster(event: any[]): void {
    this.summaryPerCluster = event;
  }

  updateSummaryById(event: any[]): void {
    this.summaryById = event;
  }

  exportReport(): any[] {
    if (this.activeIndex === 0) {
      return this.summaryPerCluster;
    } else {
      return this.summaryById;
    }
  }

  refresh(): void {
    if (this.activeIndex === 0) {
      this.clustertable?.getVulnerabilityReports();
    } else {
      this.cvetable?.getVulnerabilityReports();
    }
  }
}
