<p-table
  [sortOrder]="-1"
  sortField="score"
  [value]="report?.vulnerabilities"
  styleClass="p-datatable-striped"
  [rows]="10"
  dataKey="dataKey"
  [showCurrentPageReport]="true"
  [rowsPerPageOptions]="rowsPerPage"
  [paginator]="true"
>
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 5rem" class="p-1"></th>
      <th pSortableColumn="severity" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.severity' | translate }} <p-sortIcon field="severity"></p-sortIcon>
      </th>
      <th pSortableColumn="score" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.score' | translate }} <p-sortIcon field="score"></p-sortIcon>
      </th>
      <th pSortableColumn="vulnerabilityID" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.id' | translate }} <p-sortIcon field="vulnerabilityID"></p-sortIcon>
      </th>
      <th pSortableColumn="primaryLink" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.primaryLink' | translate }} <p-sortIcon field="primaryLink"></p-sortIcon>
      </th>
      <th pSortableColumn="resource" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.resource' | translate }} <p-sortIcon field="resource"></p-sortIcon>
      </th>
      <th pSortableColumn="installedVersion" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.installedVersion' | translate }} <p-sortIcon field="installedVersion"></p-sortIcon>
      </th>
      <th pSortableColumn="fixedVersion" class="p-1">
        {{ 'pages.clusters.details.vulnerabilityreports.fixedVersion' | translate }} <p-sortIcon field="fixedVersion"></p-sortIcon>
      </th>
    </tr>
    <tr>
      <td></td>
      <td>
        <p-columnFilter field="severity" matchMode="in" [showMenu]="false">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <p-multiSelect
              appendTo="body"
              [options]="resultFilter"
              (onChange)="filter(getValue($event.value))"
              placeholder="{{ 'common.any' | translate }}"
              optionLabel="name"
              [maxSelectedLabels]="1"
              [selectedItemsLabel]="'{0} items'"
            >
              <ng-template let-option pTemplate="item">
                <div class="">
                  <span class="">{{ option?.name }}</span>
                </div>
              </ng-template>
            </p-multiSelect>
          </ng-template>
        </p-columnFilter>
      </td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-vulnerability let-nestedExpanded="expanded">
    <tr>
      <td>
        <button
          type="button"
          pButton
          pRipple
          [pRowToggler]="vulnerability"
          class="p-button-text p-button-rounded p-button-plain"
          [icon]="nestedExpanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
        ></button>
      </td>
      <td>
        <p-badge
          *ngIf="vulnerability?.severity !== 'UNKNOWN'"
          [value]="vulnerability?.severity"
          [severity]="getBadgeColor(vulnerability?.severity)"
        ></p-badge>
        <span *ngIf="vulnerability?.severity === 'UNKNOWN'">{{ vulnerability?.severity }}</span>
      </td>
      <td>{{ vulnerability?.score }}</td>
      <td>{{ vulnerability?.vulnerabilityID }}</td>
      <td>
        <a [href]="vulnerability?.primaryLink" target="_blank" class="font-medium text-blue-600 dark:text-blue-500 hover:underline">{{
          vulnerability?.primaryLink
        }}</a>
      </td>
      <td>{{ vulnerability?.resource }}</td>
      <td>{{ vulnerability?.installedVersion }}</td>
      <td>{{ vulnerability?.fixedVersion }}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="rowexpansion" let-vulnerability>
    <tr>
      <td colspan="2">
        {{ ('pages.clusters.details.vulnerabilityreports.description' | translate) + ':' }}
      </td>
      <td colspan="6">
        {{ vulnerability.title }}
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="6">
        {{ 'common.emptyList' | translate }}
      </td>
    </tr>
  </ng-template>
</p-table>
