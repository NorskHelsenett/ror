import { Project } from './project';

export interface VulnerabilityReportsView extends VulnerabilityReportsSummary {
  clusterId: string;
  namespaces: VulnerabilityReportsViewNamespace[];
  environment: string;
  project: Project;
}

export interface VulnerabilityReportsViewNamespace extends VulnerabilityReportsSummary {
  name: string;
  reports: VulnerabilityReportsViewReport[];
}

export interface VulnerabilityReportsViewReport extends VulnerabilityReportsSummary {
  uid: string;
  name: string;
  owner_ref: ResourceMetadataOwnerReference;
  scanner: VulnerabilityReportsScanner;
  artifact: VulnerabilityReportsArtifact;
  updateTimestamp: string;
  vulnerabilities: ResourceVulnerabilityReportReportVulnerability[];
}

export interface VulnerabilityReportsArtifact {
  repository: string;
  tag: string;
}

export interface VulnerabilityReportsScanner {
  name: string;
  vendor: string;
  version: string;
}

export interface VulnerabilityReportsSummary {
  criticalCount: number;
  highCount: number;
  lowCount: number;
  mediumCount: number;
  total: number;
}

export interface ResourceMetadataOwnerReference {
  apiVersion: string;
  kind: string;
  name: string;
  uid: string;
}

export interface ResourceVulnerabilityReportReportVulnerability {
  vulnerabilityID: string;
  severity: string;
  score: number;
  title: string;
  resource: string;
  primaryLink: string;
  dataKey: string;
}

export interface VulnerabilityById {
  cveId: string;
  severity: string;
  score: number;
  title: string;
  link: string;
  affected: VulnerabilityByIdAffected[];
}

export interface VulnerabilityByIdAffected {
  clusterId: string;
  internal: boolean;
  ownerref: ResourceMetadataOwnerReference[];
  scanner: VulnerabilityReportsScanner;
  artifact: VulnerabilityReportsArtifact;
  resource: string;
  installedVersion: string;
  fixedVersion: string;
}

export interface ViewMetadata {
  clusterId: string;
  environment: string;
  criticality: Criticality;
  sensitivity: Sensitivity;
  project: Project;
}

export enum Criticality {
  Unknown = 0,
  Open,
  Internal,
  Shielded,
  HighlyShielded,
}

export enum Sensitivity {
  Unknown = 0,
  Normal,
  Moderate,
  High,
  Critical,
}
